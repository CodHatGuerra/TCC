ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY '123456';


CREATE DATABASE IF NOT EXISTS VF_Dev;
USE VF_Dev;

CREATE TABLE IF NOT EXISTS Endereco (
  ID INT NOT NULL AUTO_INCREMENT,
  Cep VARCHAR(8) NOT NULL,
  Uf VARCHAR(2) NOT NULL,
  Localidade VARCHAR(80) NOT NULL,
  Bairro VARCHAR(120) NOT NULL,
  Logradouro VARCHAR(120) NOT NULL,
  Numero VARCHAR(8) NOT NULL,
  PRIMARY KEY (ID)
) ENGINE=InnoDB;

CREATE TABLE IF NOT EXISTS Vacina (
  ID INT NOT NULL,
  Nome VARCHAR(150) NOT NULL,
  Fábrica VARCHAR(150) NOT NULL,
  Data_Fabricacao DATE NOT NULL,
  Lote VARCHAR(20) NOT NULL,
  Data_Aplicacao DATE NOT NULL,
  Dose VARCHAR(45) NOT NULL,
  Data_Vinculada DATE NOT NULL,
  PRIMARY KEY (ID),
  UNIQUE INDEX ID_Vacina_UNIQUE (ID) VISIBLE
) ENGINE=InnoDB;

CREATE TABLE IF NOT EXISTS Carteira_vacina (
  ID INT NOT NULL AUTO_INCREMENT,
  Data_Registrada DATE NOT NULL,
  Vacina_ID INT NULL,
  PRIMARY KEY (ID),
  UNIQUE INDEX ID_Carteira_UNIQUE (ID) VISIBLE,
  INDEX fk_Carteira_vacina_Vacina1_idx (Vacina_ID) VISIBLE,
  FOREIGN KEY (Vacina_ID)
    REFERENCES Vacina (ID)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
) ENGINE=InnoDB;

CREATE TABLE IF NOT EXISTS Usuario (
  ID INT NOT NULL AUTO_INCREMENT,
  Nome VARCHAR(180) NOT NULL,
  Cpf VARCHAR(11) NULL,
  Rg VARCHAR(20) NOT NULL,
  Sexo VARCHAR(35) NOT NULL,
  Data_Nascimento DATE NOT NULL,
  Email VARCHAR(120) NOT NULL,
  Senha VARCHAR(45) NOT NULL,
  Data_Criada DATE NOT NULL,
  Endereco_ID INT NULL,
  Carteira_vacina_ID INT NULL,
  PRIMARY KEY (ID),
  UNIQUE INDEX Cpf_UNIQUE (Cpf) VISIBLE,
  UNIQUE INDEX Rg_UNIQUE (Rg) VISIBLE,
  UNIQUE INDEX ID_Usuario_UNIQUE (ID) VISIBLE,
  INDEX fk_Usuario_Endereco1_idx (Endereco_ID) VISIBLE,
  INDEX fk_Usuario_Carteira_vacina1_idx (Carteira_vacina_ID) VISIBLE,
  FOREIGN KEY (Endereco_ID)
    REFERENCES Endereco (ID)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  FOREIGN KEY (Carteira_vacina_ID)
    REFERENCES Carteira_vacina (ID)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
) ENGINE=InnoDB;

CREATE TABLE IF NOT EXISTS Posto (
  ID INT NOT NULL AUTO_INCREMENT,
  Nome VARCHAR(75) NOT NULL,
  Endereco_ID INT NULL,
  PRIMARY KEY (ID),
  UNIQUE INDEX idTB_Instituição_UNIQUE (ID) VISIBLE,
  INDEX fk_Posto_Endereco1_idx (Endereco_ID) VISIBLE,
  FOREIGN KEY (Endereco_ID)
    REFERENCES Endereco (ID)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
) ENGINE=InnoDB;

CREATE TABLE IF NOT EXISTS Telefone (
  ID INT NOT NULL AUTO_INCREMENT,
  Numero VARCHAR(45) NOT NULL,
  Posto_ID INT NULL,
  Usuario_ID INT NULL,
  PRIMARY KEY (ID),
  UNIQUE INDEX ID_Celular_UNIQUE (ID) VISIBLE,
  INDEX fk_Telefone_Posto1_idx (Posto_ID) VISIBLE,
  INDEX fk_Telefone_Usuario1_idx (Usuario_ID) VISIBLE,
  FOREIGN KEY (Posto_ID)
    REFERENCES Posto (ID)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  FOREIGN KEY (Usuario_ID)
    REFERENCES Usuario (ID)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
) ENGINE=InnoDB;

CREATE TABLE IF NOT EXISTS Funcionario (
  ID INT NOT NULL AUTO_INCREMENT,
  Data_Inicio DATE NOT NULL,
  Data_Fim DATE NULL,
  Usuario_ID INT NOT NULL,
  PRIMARY KEY (ID),
  UNIQUE INDEX idTB_Funcionario_UNIQUE (ID) VISIBLE,
  INDEX fk_Funcionario_Usuario1_idx (Usuario_ID) VISIBLE,
  FOREIGN KEY (Usuario_ID)
    REFERENCES Usuario (ID)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
) ENGINE=InnoDB;

CREATE TABLE IF NOT EXISTS Funcionario_has_Posto (
  Funcionario_ID INT NOT NULL,
  Posto_ID INT NOT NULL,
  Cargo VARCHAR(45) NOT NULL,
  PRIMARY KEY (Funcionario_ID, Posto_ID),
  INDEX fk_Funcionario_has_Posto_Posto1_idx (Posto_ID) VISIBLE,
  INDEX fk_Funcionario_has_Posto_Funcionario1_idx (Funcionario_ID) VISIBLE,
  FOREIGN KEY (Funcionario_ID)
    REFERENCES Funcionario (ID)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  FOREIGN KEY (Posto_ID)
    REFERENCES Posto (ID)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
) ENGINE=InnoDB;
